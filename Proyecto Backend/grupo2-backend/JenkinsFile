pipeline {
    agent any

    stages {
        stage('Checkout') {
            steps {
                checkout scm
            }
        }

        stage('Instalar dependencias') {
            steps {
                sh '''
                  if [ -f package.json ]; then
                    echo "Instalando dependencias..."
                    npm install
                  else
                    echo "No hay package.json, se omite npm install"
                  fi
                '''
            }
        }

        stage('Build') {
            steps {
                sh '''
                  if [ -f package.json ]; then
                    echo "Ejecutando build..."
                    npm run build || echo "No hay script build, se omite"
                  else
                    echo "Proyecto est√°tico, sin build"
                  fi
                '''
            }
        }

        stage('Pruebas') {
            steps {
                sh '''
                  if [ -f package.json ]; then
                    echo "Ejecutando tests..."
                    npm test || echo "No hay tests definidos"
                  else
                    echo "No hay tests configurados"
                  fi
                '''
            }
        }
    }
}
